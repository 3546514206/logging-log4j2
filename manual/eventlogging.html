<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Event Logging with Log4j :: Apache Log4j</title>
    <link rel="canonical" href="https://logging.apache.org/log4j/2.x/manual/eventlogging.html">
    <meta name="generator" content="Antora 3.2.0-alpha.4">
<link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/../_images/favicon.ico" type="image/x-icon">
<!-- `@asciidoctor/tabs` extension styles -->
<link rel="stylesheet" href="../_/css/vendor/tabs.css">
<style>
  /* Default `h4` and `h5` are smaller than the normal text, fix header font sizing: */
  .doc h1 { font-size: 1.9rem; }
  .doc h2 { font-size: 1.7rem; }
  .doc h3 { font-size: 1.5rem; font-weight: 400; }
  .doc h4 { font-size: 1.3rem; font-weight: 500; }
  .doc h5 { font-size: 1.1rem; font-weight: 500; text-decoration: underline; }
  /* Default `code`, `pre`, and `.colist` (source code annotations) fonts are too big, adjust them: */
  .doc .colist>table code, .doc p code, .doc thead code { font-size: 0.8em; }
  .doc pre { font-size: 0.7rem; }
  .doc .colist { font-size: 0.75rem; }
  /* Tab header fonts aren't rendered good, adjusting the font weight: */
  .tablist > ul li { font-weight: 500; }
  /* `page-toclevels` greater than 4 are not supported by Antora UI, patching it: */
  .toc .toc-menu li[data-level="4"] a {
    padding-left: 2.75rem;
  }
  /* Replace the default highlight.js color for strings from red (unnecessarily signaling something negative) to green: */
  .hljs-string {
    color: #0f8532;
  }
</style>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <img src="../_/../_images/logo-small-white.png" alt="Apache Log4j"/>
      </div>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://logging.apache.org">a subproject of&nbsp;<strong>Apache Logging Services</strong></a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ROOT" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Home</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../download.html">Download</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../runtime-dependencies.html">Runtime Dependencies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../release-notes.html">Release Notes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="https://logging.apache.org/support">Support</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://logging.apache.org/security">Security</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../thanks.html">Thanks</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../faq.html">F.A.Q.</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../5min.html">Log4j explained in 5 minutes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../development.html">Development</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Manual</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="installation.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="migration.html">Migrating from Log4j 1.x to 2.x</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="api.html">Log4j API</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="logbuilder.html">Fluent API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="flowtracing.html">Flow Tracing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="markers.html">Markers</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="eventlogging.html">Event Logging with Log4j</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="messages.html">Messages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="thread-context.html">Thread Context</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="scoped-context.html">Scoped Context</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="resource-logger.html">Resource Logging</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuration.html">Configuration file</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="appenders.html">Appenders</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="layouts.html">Layouts</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="json-template-layout.html">JSON Template Layout</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="lookups.html">Lookups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="customloglevels.html">Custom Log Levels</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="filters.html">Filters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="scripts.html">Scripts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="systemproperties.html">Configuration properties</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="usage.html">Usage</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cloud.html">Using Log4j in Cloud Enabled Applications</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="lookups.html">Lookups</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="appenders.html">Appenders</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="layouts.html">Layouts</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="json-template-layout.html">JSON Template Layout</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="filters.html">Filters</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="extending.html">Extending Log4j</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="customconfig.html">Programmatic Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="plugins.html">Plugins</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="customconfig.html">Programmatic Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="customloglevels.html">Custom Log Levels</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="jmx.html">JMX</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="logsep.html">Logging Separation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="performance.html">Performance</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="async.html">Asynchronous loggers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="garbagefree.html">Garbage-free logging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">References</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-reference.html">Plugin reference</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../javadoc.html">Java API reference</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Components</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-api.html">Log4j API</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-1.2-api.html">Log4j 1.2 Bridge</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-slf4j-impl.html">Log4j SLF4J Binding</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-jul.html">Log4j JDK Logging Adapter</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-jpl.html">Log4j JDK Platform Logging Adapter</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-to-slf4j.html">Log4j to SLF4J Adapter</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-flume-ng.html">Flume Appender</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-mongodb3.html">MongoDB 3 appender</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-mongodb4.html">MongoDB 4 appender</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-iostreams.html">Log4j IOStreams</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-docker.html">Log4j Docker Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-spring-cloud-config-client.html">Log4j Spring Cloud Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Related projects</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="/log4j/jakarta">Log4j Jakarta EE</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="/log4j/jmx-gui">Log4j JMX GUI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="/log4j/kotlin">Log4j Kotlin</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="/log4j/scala">Log4j Scala</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="/log4j/tools">Log4j Tools</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="/log4j/transform">Log4j Transformation Tools</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="index.html">Manual</a></li>
    <li><a href="api.html">Log4j API</a></li>
    <li><a href="eventlogging.html">Event Logging with Log4j</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/apache/logging-log4j2/edit/2.x/src/site/antora/modules/ROOT/pages/manual/eventlogging.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="4">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Event Logging with Log4j</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The <code>EventLogger</code> class provides a mechanism for logging significant events
in an application using structured data. This approach is beneficial for
tracking user actions, monitoring system behavior, and debugging issues.</p>
</div>
<div class="paragraph">
<p>Theoretically, every <code>Logger</code> can be used to perform this kind of action;
however, the <code>EventLogger</code> class provides a shortcut to log events with structured data
since it allows for a static method to log events.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advantages_of_structured_logging"><a class="anchor" href="#_advantages_of_structured_logging"></a>Advantages of Structured Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Structured logging means events Log4j records events with detailed and structured information.
That way, logs are easier to read and process. They provide better context and
are also more consistent than plain text logs.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_integration_with_syslog"><a class="anchor" href="#_integration_with_syslog"></a>Integration with Syslog</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Log4j complies with Syslogs RFC5424 standard.
This feature allows for easy integration with existing log management and monitoring systems.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_configuration"><a class="anchor" href="#_example_configuration"></a>Example Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To configure Log4j to output logs in Syslog (RFC5424) format, one needs to use the <a href="../javadoc/log4j-core/org/apache/logging/log4j/core/layout/StructuredDataLayout.html"><code>StructuredDataLayout</code></a> layout.
Developers can use the following configuration to log events to a local Syslog server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;Appenders&gt;
    &lt;Syslog name="Syslog" host="localhost" port="514"&gt; <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;StructuredDataLayout complete="true" /&gt; <i class="conum" data-value="2"></i><b>(2)</b>
    &lt;/Syslog&gt;
&lt;/Appenders&gt;

&lt;Loggers&gt;
    &lt;Logger name="MyApp" level="info" additivity="false"&gt;
        &lt;AppenderRef ref="Syslog"/&gt;
    &lt;/Logger&gt;
&lt;/Loggers&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>Syslog</code> appender sends logs to a local Syslog server.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>StructuredDataLayout</code> layout formats logs in RFC5424 format.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Of course, sending logs to a Syslog server is unnecessary.
Developers can use the <code>StructuredDataLayout</code> layout with any other appender, such as <code>FileAppender</code> or <code>ConsoleAppender</code>.</p>
</div>
<div class="paragraph">
<p>As an example, the output could look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">&lt;165&gt;1 2024-05-16T12:34:56.789Z myapp MyApp - ID47 [transfer@12345 toAccount="123456" fromAccount="654321" amount="1000"] User 654321 has transferred 1000 to account 123456</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_eventlogger"><a class="anchor" href="#_using_the_eventlogger"></a>Using the <code>EventLogger</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>EventLogger</code> class provides a simple way to log structured events.
It uses the <code>StructuredDataMessage</code> class to create structured log messages.</p>
</div>
<div class="paragraph">
<p>Assume a simple application that performs funds transfers between accounts.
This application should send a certain amount of funds from one account to another and log the event.</p>
</div>
<div class="paragraph">
<p>The account class is defined as follows, with a unique ID and a balance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">class Account {
    private String id;
    private long balance;
    // Getters and setters omitted for brevity
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>transfer()</code> method transfers funds between two accounts and logs the event.
It needs to take two accounts and the amount to transfer as parameters.</p>
</div>
<div class="paragraph">
<p>Apart from the key-value pairs provided in the map of the <code>StructuredDataMessage,</code>
the <code>StructuredDataMessage</code> also takes a unique ID, a free-form message, and a type as parameters.</p>
</div>
<div class="paragraph">
<p>The free-form message is a human-readable description of the event.
This message is good for operators who need to understand the event quickly,
but not so much for automated processing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public static String transferFunds(Account toAccount, Account fromAccount, long amount) {
    toAccount.deposit(amount);
    fromAccount.withdraw(amount);

    // Create a unique ID for the transaction
    String confirm = UUID.randomUUID().toString();

    String freeFormMessage = "User " + fromAccount.getId() + " has transferred " + amount + " to account " + toAccount.getId(); <i class="conum" data-value="1"></i><b>(1)</b>

    // Create the StructuredDataMessage
    StructuredDataMessage msg = new StructuredDataMessage(confirm, freeFormMessage, "transfer"); <i class="conum" data-value="2"></i><b>(2)</b>
    msg.put("toAccount", toAccount.getId()); <i class="conum" data-value="3"></i><b>(3)</b>
    msg.put("fromAccount", fromAccount.getId());
    msg.put("amount", amount);

    // Log the event
    EventLogger.logEvent(msg); <i class="conum" data-value="4"></i><b>(4)</b>

    return confirm;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The free-form message is a human-readable description of the event.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>StructuredDataMessage</code> constructor takes an ID, the free-form message, and a type.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Developers can add key-value pairs to the message.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>EventLogger</code> logs the event.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That way, the <code>transferFunds()</code> method logs the event with structured data
by using the <code>EventLogger</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_web_application_example"><a class="anchor" href="#_web_application_example"></a>Web Application Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a web application, developers can use a servlet filter to populate the
<code>ThreadContext</code> map with data related to the request.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates how a <code>Filter</code> could investigate the request
and populate the <code>ThreadContext</code> map with data such as the user&#8217;s IP address,
the user&#8217;s login ID, the server&#8217;s hostname, the product name, the locale, and the timezone.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.apache.logging.log4j.ThreadContext;
import org.apache.commons.lang.time.DateUtils;

import javax.servlet.*;
import javax.servlet.http.*;
import java.io.IOException;
import java.util.TimeZone;

public class RequestFilter implements Filter {
    private FilterConfig filterConfig;
    private static String TZ_NAME = "timezoneOffset";

    // Other methods ommitted for brevity

    /**
     * Sample filter that populates the MDC on every request.
     */
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)
            throws IOException, ServletException {
        HttpServletRequest request = (HttpServletRequest)servletRequest;

        ThreadContext.put("ipAddress", request.getRemoteAddr()); <i class="conum" data-value="1"></i><b>(1)</b>

        HttpSession session = request.getSession(false);
        if (session != null) {
            // Assuming, an authentication filter has already populated the loginId in the session
            String loginId = (String)session.getAttribute("loginId");
            if (loginId != null) {
                ThreadContext.put("loginId", loginId);
            }
        }

        ThreadContext.put("hostname", servletRequest.getServerName());
        ThreadContext.put("productName", filterConfig.getInitParameter("ProductName"));
        ThreadContext.put("locale", servletRequest.getLocale().getDisplayName());
        ThreadContext.put("timezone", TimeZone.getDefault().getDisplayName());

        filterChain.doFilter(servletRequest, servletResponse);
        ThreadContext.clear();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>doFilter()</code> method populates the <code>ThreadContext</code> map with data related to the request.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>Filter</code> needs to be registered in your <code>web.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;filter&gt;
    &lt;filter-name&gt;RequestFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;com.example.RequestFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
        &lt;param-name&gt;ProductName&lt;/param-name&gt;
        &lt;param-value&gt;YourProductName&lt;/param-value&gt;
    &lt;/init-param&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
    &lt;filter-name&gt;RequestFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt; <i class="conum" data-value="1"></i><b>(1)</b>
&lt;/filter-mapping&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>RequestFilter</code> is mapped to all requests.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Eventually, a <code>Servlet</code> or any other related class, such as a Spring Controller, can be used to log events with structured data.
The following example uses a <code>Servlet</code> to call the <code>EventLogger</code> and log a user action.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import javax.servlet.*;
import javax.servlet.http.*;
import java.io.IOException;

public class UserActionServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userId = request.getParameter("userId");
        String action = request.getParameter("action");
        String details = request.getParameter("details");

        // Perform and log the user action
        String message = "User " + userId + " performed action: " + action;
        StructuredDataMessage msg = new StructuredDataMessage(UUID.randomUUID().toString(), message, "userAction"); <i class="conum" data-value="1"></i><b>(1)</b>
        msg.put("userId", userId);
        msg.put("action", action);
        msg.put("details", details);

        // Log the event
        EventLogger.logEvent(msg);

        // Respond to the client
        response.getWriter().write("Action logged successfully");
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>userAction</code> is the name of the current transaction</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That way, not only the data provided to the <code>EventLogger</code> is used, but also all the
data populated in the <code>ThreadContext</code> map is included in the log message.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_benefits_of_structured_logging"><a class="anchor" href="#_benefits_of_structured_logging"></a>Benefits of Structured Logging</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Improved Readability and Context:</strong>
Structured logs include detailed information, making them easier to understand and analyze.</p>
</li>
<li>
<p><strong>Better for Automated Processing:</strong>
Structured logs are easily parsed by existing log management tools.</p>
</li>
<li>
<p><strong>Consistency:</strong>
Structured logging enforces a consistent format, helping to identify patterns in logs.</p>
</li>
<li>
<p><strong>Performance Optimization:</strong>
Structured messages are - as all messages - only constructed when necessary, keeping overhead low.</p>
</li>
</ol>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>
    Copyright © 1999-2024 <a href="https://www.apache.org/">The Apache Software Foundation</a>.
    Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache Software License, Version 2.0</a>.
    Please read our <a href="https://privacy.apache.org/policies/privacy-policy-public.html">privacy policy</a>.
  </p>
  <p>
    Apache, Log4j, and the Apache feather logo are trademarks or registered trademarks of The Apache Software Foundation.
    Oracle and Java are registered trademarks of Oracle and/or its affiliates.
    Other names may be trademarks of their respective owners.
  </p>
</footer>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async src="../_/js/vendor/highlight.js"></script>
<!-- `@asciidoctor/tabs` extension scripts -->
<script async src="../_/js/vendor/tabs.js"></script>
  </body>
</html>
